<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wuxianggujun.wuxiangblog.mapper.BlogMapper">

    <resultMap id="User" type="com.wuxianggujun.wuxiangblog.entity.User">
        <id property="id" column="id"/>
        <result property="avatar" column="avatar"/>
        <result property="createTime" column="create_time"/>
        <result property="email" column="email"/>
        <result property="nickname" column="nickname"/>
        <result property="password" column="password"/>
        <result property="type" column="type"/>
        <result property="updateTime" column="update_time"/>
        <result property="username" column="username"/>
    </resultMap>

    <resultMap id="blog" type="com.wuxianggujun.wuxiangblog.entity.Blog">
        <id property="id" column="id"/>
        <result property="appreciation" column="appreciation"/>
        <result property="commentable" column="commentabled"/>
        <result property="content" column="content"/>
        <result property="createTime" column="create_time"/>
        <result property="description" column="description"/>
        <result property="firstPicture" column="first_picture"/>
        <result property="flag" column="flag"/>
        <result property="published" column="published"/>
        <result property="recommend" column="recommend"/>
        <result property="shareStatement" column="share_statement"/>
        <result property="title" column="title"/>
        <result property="updateTime" column="update_time"/>
        <result property="views" column="views"/>
        <result property="typeId" column="type_id"/>
        <result property="userId" column="user_id"/>
        <result property="commentCount" column="comment_count"/>
        <association property="type" javaType="com.wuxianggujun.wuxiangblog.entity.Type">
            <id property="id" column="id"/>
            <result property="name" column="name"/>
        </association>
    </resultMap>

    <!--    <select id="listBlogs" resultMap="blog">-->
    <!--        select b.id,-->
    <!--               b.title,-->
    <!--               b.update_time,-->
    <!--               b.recommend,-->
    <!--               b.published,-->
    <!--               b.type_id,-->
    <!--               t.id,-->
    <!--               t.name-->
    <!--        from wuxiangblog.t_blog b-->
    <!--                 left outer join-->
    <!--             wuxiangblog.t_type t on b.type_id = t.id-->
    <!--        order by b.create_time desc-->
    <!--    </select>-->

    <select id="searchBlogs" resultType="com.wuxianggujun.wuxiangblog.pojo.SearchBlog" resultMap="blog">
        <bind name="pattern" value="'%'+title+'%'"/>
        SELECT b.id, b.create_time,b.first_picture,
        b.recommend, b.title,b.type_id,t.id, t.name FROM wuxiangblog.t_blog b,wuxiangblog.t_type t
        <where>
            <if test="1 == 1">
                b.type_id =t.id
            </if>
            <if test="typeId != null">
                and b.type_id = #{typeId}
            </if>
            <if test="title != null">
                and b.title like #{pattern}
            </if>
        </where>
    </select>
    <select id="list" resultType="com.wuxianggujun.wuxiangblog.vo.SearchBlogVo">
        select tb.id,
               tb.create_time,
               tb.recommend,
               tb.title,
               tb.type_id,
               tt.id,
               tt.name
        from wuxiangblog.t_blog tb
                 left join wuxiangblog.t_type tt on tb.type_id = tt.id

    </select>
</mapper>